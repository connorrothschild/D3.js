<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Born Again Kanye</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
    /* custom css styles will go here */
		h2{
			text-align: center;
			font-family: 'Krub', sans-serif;
		}
		svg{
    		max-width; 500px;
    		margin-left: auto;
    		margin-right: auto;
    		display: block;
		}
		p{
			max-width: 700px;
			margin-left: auto;
			margin-right: auto;
			font-family: 'Krub', sans-serif;
		}
		
		p1{
			max-width: 700px;
			margin-left: 500;
			margin-right: 500;
			font-family: 'Krub', sans-serif;
			font-size: 12px;
			
			
		}
		#data-source{
			margin-right: auto;
			margin-left: 0;
			font-size: 10px;
			margin-top: 3px;
			margin-bottom: 10px;
			font-family: 'Krub', sans-serif;
		}

    .bar:hover {
      fill: brown;
    }
	
		
    </style>

	
</head>
	
<body>

    <script src="https://d3js.org/d3.v5.min.js"></script>

    <script>
      var margin = {top:60, right:10, bottom:20, left:100},
          width  = 1300 - margin.left - margin.right,
          height = 600 - margin.top - margin.bottom;
      var svg = d3.select("body")
          .append("svg")
          .attr("width", "100%")
          .attr("height", "100%")
          .attr("viewBox", "0 0 " + (width + margin.left + margin.right) + " " + (height + margin.top + margin.bottom));
      var chart = svg.append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
      var xScale = d3.scaleLinear()
          .range([0, width]);
      var yScale = d3.scaleBand()
          .range([0, height])
          .padding(0.1);

d3.csv("kanye_data.csv")
.then(function(data){

        data = data.map(function(d){ 
            d.album_name = d.album_name; // convert "Year" column to Date
            d.danceability = +d.danceability;
            d.energy = +d.energy;
            d.key = +d.key;
            d.loudness = +d.loudness;
            d.mode = +d.mode;
            d.speechiness = +d.speechiness;
            d.acousticness = +d.acousticness;
            d.instrumentalness = +d.instrumentalness;
            d.liveness = +d.liveness;
            d.valence = +d.valence;
            d.tempo = +d.tempo;
            return d;

      });

        data.sort(function(a, b) {
        
        return b.danceability - a.danceability;

        });
		  
		
        xScale.domain([0, 1]);
        yScale.domain(data.map(function(d){ return d.album_name; }))
		  
        chart.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", 0)/*function(d){ return xScale(d["Breastfeeding at 6 months (2008)"]); })*/
            .attr("y", function(d){ return yScale(d.album_name); })
            .attr("height", function(d){ return yScale.bandwidth(); })
            .attr("width", 0)
            .attr("fill", function (d) {
                if (d.album_name == "JESUS IS KING") {
                    return "brown";
                } else {
                    return "steelblue";
                };

            });           
          
		  
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .selectAll(".textlabel-1")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "textlabel-1")
            .attr("x", function(d){ return xScale(d.danceability) +28;})
            .attr("y", function(d){ return yScale(d.album_name) +16; })
		  	.attr("alignment-baseline", "hanging")
            .attr("text-anchor", "end")
            .attr("font-family", "sans-serif")
            .attr("font-size", "12px")
		  	.attr("fill", "black")
            .text(function(d){ return d3.format(",")(d.danceability.toFixed(2)); })
		  
        //adding y axis to the left of the chart
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .call(d3.axisLeft(yScale));

        //adding x axis to the bottom of chart
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")")
            .call(d3.axisBottom(xScale));
        
        svg.append("g")
            .attr("transform", "translate(" + (width/1.8) + ", 15)")
            .append("text")
            .text("Kanye West's Rebirth")
            .style("text-anchor", "middle")
            .style("font-family", "Arial")
            .style("font-weight", "600");
		  
        svg.append("g")
            .attr("transform", "translate(" + (width/1.8) + ", 35)")
            .append("text")
            .text("Differences in danceability by album.")
            .style("text-anchor", "middle")
            .style("font-family", "Arial")
            .style("font-weight", "100")
		  	.style("font-size","12");

          svg.selectAll("rect")
              .transition()
              .duration(800)
              .attr("y", function(d) { return yScale(d.album_name); })
              .attr("width", function(d) { return xScale(d.danceability); })
              .delay(function(d,i){console.log(i) ; return(i*100)})
		 
      });   
		
		
    </script>
    </body>
</html>