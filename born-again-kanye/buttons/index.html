<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v5.min.js"></script>

<!-- Add 2 buttons -->
<button onclick="update(data1)">Acousticness</button>
<button onclick="update(data2)">Energy</button>
<button onclick="update(data3)">Mode</button>
<button onclick="update(data4)">Speechiness</button>
<button onclick="update(data5)">Instrumentalness</button>
<button onclick="update(data6)">Liveness</button>
<button onclick="update(data7)">Valence</button>
<!-- Create a div where the graph will take place -->

<script>

      var margin = {top:30, right:10, bottom:100, left:150},
          width  = 1300 - margin.left - margin.right,
          height = 600 - margin.top - margin.bottom;
      var svg1 = d3.select("body")
          .append("svg")
          .attr("width", "100%")
          .attr("height", "100%")
          .attr("viewBox", "0 0 " + (width + margin.left + margin.right) + " " + (height + margin.top + margin.bottom));

      var chart = svg1.append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
      var xScale = d3.scaleLinear()
          .range([0, width]);

      var yScale = d3.scaleBand()
          .range([0, height])
          .padding(0.1); 

d3.csv("kanye_data.csv")
.then(function(data){

        var data1 = data.map(function(d){ 
            d.album_name = d.album_name;
            d.variable = +d.acousticness;
            return d;
        })

        var data2 = data.map(function(d){ 
            d.album_name = d.album_name; 
            d.variable = +d.energy;
            return d;
        })

        var data3 = data.map(function(d){ 
            d.album_name = d.album_name;
            d.variable = +d.mode;
            return d;
        })

        var data4 = data.map(function(d){ 
            d.album_name = d.album_name; 
            d.variable = +d.speechiness;
            return d;
        })

        var data5 = data.map(function(d){ 
            d.album_name = d.album_name;
            d.variable = +d.instrumentalness;
            return d;
        })

        var data6 = data.map(function(d){ 
            d.album_name = d.album_name; 
            d.variable = +d.liveness;
            return d;
        })

        var data7 = data.map(function(d){ 
            d.album_name = d.album_name;
            d.variable = +d.valence;
            return d;
        })

// A function that create / update the plot for a given variable:
function update(data) {

  // Update the X axis
  xScale.domain([0, d3.max(data, function (d) { return d.variable * 1.1; })]);
  //xAxis.call(d3.axisBottom(x));

  // Update the Y axis
  yScale.domain(data.map(function(d){ return d.album_name; }));
  //yAxis.transition().duration(1000).call(d3.axisLeft(y));

	var u = chart.selectAll(".bar")
	    .data(data)

	 u
	    .enter()
	    .append("rect")
	    .merge(u)
	    .transition()
	    .attr("class", "bar")
	    .attr("x", 0)
	    .attr("y", function(d){ return yScale(d.album_name); })
	    .attr("height", function(d){ return yScale.bandwidth(); })
	    .attr("width", function(d){ return yScale(d.variable); })
	    .attr("fill", function (d) {
	        if (d.album_name == "JESUS IS KING") {
	            return "brown";
	        } else {
	            return "steelblue";
	        };

	    });           
	  
	svg1.append("g")
	    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
	    .selectAll(".textlabel-1")
	    .data(data)
	    .enter()
	    .append("text")
	    .transition()
	    .duration(800)
	    .attr("class", "textlabel-1")
	    .attr("x", function(d){ return xScale(d.variable) +32;})
	    .attr("y", function(d){ return yScale(d.album_name) +12; })
	  	.attr("alignment-baseline", "hanging")
	    .attr("text-anchor", "end")
	    .attr("font-family", "Lato")
	    .attr("font-size", "14px")
	  	.attr("fill", "black")
	    .text(function(d){ return d3.format(",")(d.variable.toFixed(2)); });
	  
	//adding y axis to the left of the chart
	svg1.append("g")
	    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
	    .call(d3.axisLeft(yScale));

	//adding x axis to the bottom of chart
	svg1.append("g")
	    .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")")
	    .call(d3.axisBottom(xScale));

	  svg1.selectAll("rect")
	      .transition()
	      .duration(800)
	      .attr("y", function(d) { return yScale(d.album_name); })
	      .attr("width", function(d) { return xScale(d.variable); })
	      .delay(function(d,i){ return(i*100)});

	  svg1.append("text")             
	      .attr("transform",
	            "translate(" + (width/1.8) + " ," + 
	                           (height + margin.top + 50) + ")")
	      .style("text-anchor", "middle")
	      .text("Acousticness");

};

update(data7)

});

</script>