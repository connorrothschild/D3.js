<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Born Again Kanye</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
     
     h1 {
      text-align: center;
      font-family: 'Lato', sans-serif;
            }
    
    h2 {
      text-align: center;
      font-family: 'Lato', sans-serif;
    }

    svg {
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }
    p {
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      font-family: 'Lato', sans-serif;
    }

	.pTitle {
	  font-size: 16px;
	  text-shadow: 0 1px 0 #fff;
	  fill: #474747;
	  font-weight: bold;
		}

	#buttons {
	  text-align: center;
      font-family: 'Lato', sans-serif;
	}
      
    }
    #data-source{
      margin-right: auto;
      margin-left: 0;
      font-size: 10px;
      margin-top: 3px;
      margin-bottom: 10px;
      font-family: 'Lato', sans-serif;
    }
    .bar:hover {
      fill: brown;
    }
  
    
    </style>

    <h1> <img src="https://d063e17xn2-flywheel.netdna-ssl.com/wp-content/uploads/2019/10/https-hypebeast.com-image-2019-10-kanye-west-jesus-is-king-album-release-stream-spotify-apple-music-download-11-1-1.jpg" width = "78", height = "52", align = "center">Kanye West's Rebirth <img src="https://d063e17xn2-flywheel.netdna-ssl.com/wp-content/uploads/2019/10/https-hypebeast.com-image-2019-10-kanye-west-jesus-is-king-album-release-stream-spotify-apple-music-download-11-1-1.jpg" width = "78", height = "52", align = "center"></h1>
  
</head>

<body>

		<p>How does Kanye West's most recent album compare to his previous ones? Has he went through some form of transformation?</p>

    	<p>How does <span style = "color:brown">Jesus is King</span> compare to his other albums?</p> 

				<div id="buttons"></div>
				<div id="SideText">
				  <p id="p0" class="pTitle Side">Acousticness</p>
			 	  <p id="p1" class="Side">Placeholder text</p>
					<p id="p2" class="Side">Placeholder text 2</p>
			  </div>
  
<body>

    <script src="https://d3js.org/d3.v5.min.js"></script>

    <script>

      var margin = {top:30, right:10, bottom:100, left:150},
          width  = 1300 - margin.left - margin.right,
          height = 600 - margin.top - margin.bottom;

      var svg = d3.select("body")
		          .append("svg")
		          .attr("width", "100%")
		          .attr("height", "100%")
		          .attr("viewBox", "0 0 " + (width + margin.left + margin.right) + " " + (height + margin.top + margin.bottom));

      var chart = svg.append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
      var xScale = d3.scaleLinear()
          .range([0, width]);

      var yScale = d3.scaleBand()
          .range([0, height])
          .padding(0.1); 

var selected_variable = 'd.danceability';
var selected_variable_scaled = 'd.danceability_scaled';
var pre_symbol = ""
var post_symbol = ""
var pretty_variable = "Danceability: "
var formatValue = d3.format(".2n");

d3.csv("kanye_data.csv")
.then(function(data){
        data = data.map(function(d){ 
            d.album_name = d.album_name;
            d.danceability = +d.danceability;
            d.energy = +d.energy;
            d.key = +d.key;
            d.loudness = +d.loudness;
            d.mode = +d.mode;
            d.speechiness = +d.speechiness;
            d.acousticness = +d.acousticness;
            d.instrumentalness = +d.instrumentalness;
            d.liveness = +d.liveness;
            d.valence = +d.valence;
            d.tempo = +d.tempo;
            d.image = d.image;
            return d;
      });

        console.table(data);
        
        data.sort(function(a, b) {
        
        return b[selected_variable_scaled] - a[selected_variable_scaled];

        });
      
    
        xScale.domain([0, d3.max(data, function (d) { return d[selected_variable_scaled] * 1.1; })]);

        yScale.domain(data.map(function(d){ return d.album_name; }));

       // var yAxis = d3.axisLeft(yScale)
       //         .tickFormat(function(d){ return d.image;});;

        //  var ticks = svg.select(".axis").selectAll(".tick")
        //            .data(data)
        //            .append("svg:image")
        //            .attr("xlink:href", function (d) { return d[image ;// })
        //            .attr("width", 100)
        //            .attr("height", 100)
        //            .attr("x", -120)
        //            .attr("y", -50);
      
        chart.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", 0)
            .attr("y", function(d){ return yScale(d.album_name); })
            .attr("height", function(d){ return yScale.bandwidth(); })
            .attr("width", function(d){ return d[selected_variable_scaled]; })
            .attr("fill", function (d) {
                if (d.album_name == "JESUS IS KING") {
                    return "brown";
                } else {
                    return "steelblue";
                };
            });           
          
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .selectAll(".textlabel-1")
            //.data(data)
            //.enter()
            .append("text")
            .transition()
            .duration(800)
            .attr("class", "textlabel-1")
            .attr("x", function(d){ return xScale(d[selected_variable]) +32;})
            .attr("y", function(d){ return yScale(d.album_name) +12; })
        .attr("alignment-baseline", "hanging")
            .attr("text-anchor", "end")
            .attr("font-family", "Lato")
            .attr("font-size", "14px")
        .attr("fill", "black")
            .text(function(d){ return d[selected_variable_scaled]; });
            	//return d3.format(",")(selected_variable.toFixed(2)); })
      
        //adding y axis to the left of the chart
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
          	//.enter()
        	//.append("svg:image")
          	//.attr("xlink:href", function (d) { return d[image ; })
            .call(d3.axisLeft(yScale))

  //       svg.selectAll(".y .tick").each( function(d) {
	//         console.log("d", d);
	//         var p = d3.select(this);
	//         p.append("svg:image")
	//         .attr("x", -9)
	//         .attr("y", 3)
	//         .attr("dy", ".35em")
	//         .attr("width", 18)
	//         .attr("height", 18)
	//         .attr("xlink:href", 'assets/jesusisking.jpg')
	//     });
        
        //adding x axis to the bottom of chart
        svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + (height + margin.top) + ")")
            .call(d3.axisBottom(xScale));
        
          svg.selectAll("rect")
          	  .data(data)
              .transition()
              .duration(800)
              .attr("y", function(d) { return yScale(d.album_name); })
              .attr("width", function(d) { return xScale(d[selected_variable_scaled]); })
              .delay(function(d,i){ return(i*100)})
          svg.append("text")             
              .attr("transform",
                    "translate(" + (width/1.8) + " ," + 
                                   (height + margin.top + 50) + ")")
              .style("text-anchor", "middle")
              .text("Acousticness");  

var buttons = d3.selectAll('#buttons')
buttons.append('button')
			 .text('Acousticness')
			 .style("font-size", "10px")
			 //.style("font-family", "Helvetica Neue")
			 .style("padding", "8px")
			 .style("color", "black")
  	 	//.style("text-shadow", "0 1px 2px rgba(0, 0, 0, 0.25)")
		  .style("background", "#ecf0f1")
		  .style("border", "2px solid white")
		  .style("cursor", "pointer")
		  .style("-webkit-box-shadow", "inset 0 -2px #dadedf")
		  .style("box-shadow", "inset 0 -2px #dadedf")
			 .attr('value', 'd.acousticness')
			 .classed('d_sel', true)
			 .on("mouseover", function(d) {
				 d3.select(this)
				 		.style("background", "brown")
						.style("color", "white")
			 })
			 .on("mouseout", function(d) {
				 d3.select(this)
				 	.style("background", "#ecf0f1")
				 	.style("color", "#454545")
			 })

buttons.append('button')
			 .text('Danceability')
			 .style("font-size", "10px")
			 //.style("font-family", "Helvetica Neue")
			 .style("padding", "8px")
			 .style("color", "black")
  	 	//.style("text-shadow", "0 1px 2px rgba(0, 0, 0, 0.25)")
		  .style("background", "#ecf0f1")
		  .style("border", "2px solid white")
		  .style("cursor", "pointer")
		  .style("-webkit-box-shadow", "inset 0 -2px #dadedf")
		  .style("box-shadow", "inset 0 -2px #dadedf")
			 .attr('value', 'd.danceability')
			 .classed('d_sel', true)
			 .on("mouseover", function(d) {
				 d3.select(this)
				 		.style("background", "brown")
						.style("color", "white")
			 })
			 .on("mouseout", function(d) {
				 d3.select(this)
				 	.style("background", "#ecf0f1")
				 	.style("color", "#454545")
			 })


d3.selectAll('.d_sel').on('click', function(){
		selected_variable = this.value;
		selected_variable_scaled = this.value + '_scaled';

        xScale.domain([0, d3.max(data, function (d) { return d[selected_variable] * 1.1; })]);

        yScale.domain(data.map(function(d){ return d.album_name; }))

  //     var yAxis = d3.axisLeft(yScale)
  //             .tickFormat(function(d){ return d[image;});;

        //  var ticks = svg.select(".axis").selectAll(".tick")
        //            .data(data)
        //            .append("svg:image")
        //            .attr("xlink:href", function (d) { return d[image ;// })
        //            .attr("width", 100)
        //            .attr("height", 100)
        //            .attr("x", -120)
        //            .attr("y", -50);
      
 //       chart.selectAll(".bar")
 //           .data(data)
 //           .enter()
 //           .append("rect")
 //           .attr("class", "bar")
 //           .attr("x", 0)
 //           .attr("y", function(d){ return yScale(d[album_name); })
 //           .attr("height", function(d){ return yScale.bandwidth(); })
 //           .attr("width", 0)
 //           .attr("fill", function (d) {
 //               if (d[album_name == "JESUS IS KING") {
 //                   return "brown";
 //               } else {
 //                   return "steelblue";
 //               };
 //           });           
         
		if(selected_variable == "d.danceability") {
			pre_symbol = ""
			post_symbol = ""
			pretty_variable = "Danceability: "
			formatValue = d3.format(".2n");
			d3.select("#p0").transition().duration(800).style("opacity", 1).text("Danceability");
			d3.select("#p1").transition().duration(800).style("opacity", 1).text("Placeholder text.");
			d3.select("#p2").transition().duration(800).style("opacity", 1).text("Placeholder text 2");
			//d3.select("#less").transition().duration(800).style("opacity", 1).//text("Less happy");
			//d3.select("#more").transition().duration(800).style("opacity", 1).//text("More happy");
		} else if (selected_variable == "d.acousticness") {
			pre_symbol = "$"
			post_symbol = ""
			pretty_variable = "Acousticness: "
			formatValue = d3.format(",");
			d3.select("#p0").transition().duration(800).style("opacity", 1).text("Acousticness");
			d3.select("#p1").transition().duration(800).style("opacity", 1).text("Placeholder text.");
			d3.select("#p2").transition().duration(800).style("opacity", 1).text("Placeholder text 2");
			//d3.select("#less").transition().duration(800).style("opacity", 1).//text("Less happy");
			//d3.select("#more").transition().duration(800).style("opacity", 1).//text("More happy");
		};

	});

}); 

    </script>
    </body>
</html>